---
layout: default
title: Mysql 知识
description: ''
show_header: true
---

### 数据库维护

> **ANALYZE TABLE tablename;** 用来检查表键是否正确
>
> **CHECK TABLE tablename;** 用来检查表的问题
>
> **OPTIMIZE TABLE tablename;** 用来回收被大量删除的表空间
>
> **mysqld --help --safe-mode --version**

### 日志

> 1. 错误日志
> 2. 查询日志
> 3. 二进制日志 (记录更新过数据的所有语句)
> 4. 缓慢查询日志

### 性能调优

> 查看当前设置：
>
> **SHOW VARIABLES;**
>
> **SHOW STATUS;**
>
> mysql 是一个多用户多线程的DBMS，某一任务执行缓慢，所有的任务都会执行缓慢
>
> **SHOW PROCESSLIST;**(显示所有的活动进程)
>
> **EXPLAIN sql statement** (解释如何执行sql语句)
>
> 不要在SELECT语句中使用太多的OR，可以用多条SELECT语句联合UNION
>
> LIKE 查询很慢


### 开发环境 ubuntu 14.04 64位

一开始系统装的mysql版本为5.5，想用到mysql的json字段类型，换用5.7

首先 卸载mysql

```
sudo apt-get remove --purge mysql*

sudo apt-get autoremove

sudo apt-get autoclean
```

安装mysql5.7

```
wget http://dev.mysql.com/get/mysql-apt-config_0.6.0-1_all.deb

sudo dpkg -i mysql-apt-config_0.6.0-1_all.deb

选mysql-5.7

选Apply

sudo apt-get update

sudo apt-get install mysql-server

sudo mysql_secure_installation

mysql --version
```

安装MySQL-python时mysql_config not found发生错误

```
sudo apt-get install libmysqld-dev (使用apt-get安装的MySQL是没有mysql_config文件)

pip install mysqlclient

或

ln -s /usr/local/mysql/bin/mysql_config /usr/local/bin/mysql_config
```

发生Table 'performance_schema.session_variables' doesn't exist错误
```
mysql> set @@global.show_compatibility_56=ON;
```

### mysql写入中文发生错误

```UnicodeEncodeError: 'latin-1' codec can't encode characters in position 0-3: ordinal not in range(256)">```

解决方法是
```
在创建数据的时候指定字符
create database douban_movie_top250 default character set utf8 default collate utf8_general_ci;

操作数据库的时候，如果使用sqlalchemy，则create_engine('mysql+mysqldb://USER:@SERVER:PORT/DB?charset=utf8', encoding='utf-8')```
