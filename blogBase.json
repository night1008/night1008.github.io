{"singlePage": [], "startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "light", "nightTheme": "dark", "urlMode": "pinyin", "script": "", "style": "", "head": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "allHead": "", "title": "Night1008", "subTitle": "\u9759\u4ee5\u4fee\u8eab\uff0c\u4fed\u4ee5\u517b\u5fb7", "avatarUrl": "https://github.githubassets.com/favicons/favicon.svg", "GMEEK_VERSION": "last", "postListJson": {"P2": {"htmlDir": "docs/post/ru-he-jin-xing-qian-hou-duan-jing-tai-zi-yuan-fen-li.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u5982\u4f55\u8fdb\u884c\u524d\u540e\u7aef\u9759\u6001\u8d44\u6e90\u5206\u79bb", "postUrl": "post/ru-he-jin-xing-qian-hou-duan-jing-tai-zi-yuan-fen-li.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/2", "commentNum": 0, "wordCount": 3094, "description": "\u6211\u76ee\u524d\u5f00\u53d1\u7684\u5e73\u53f0\u7684\u524d\u7aef\u9759\u6001\u8d44\u6e90\u662f\u4f7f\u7528 [go embed](https://pkg.go.dev/embed) \u673a\u5236\u5185\u5d4c\u5230\u540e\u7aef\u670d\u52a1\u4e2d\uff0c\r\n\u5f53\u8bbf\u95ee\u91cf\u6bd4\u8f83\u5927\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u4f1a\u6709\u6bd4\u8f83\u5927\u7684 IO \u6d88\u8017\uff0c\u56e0\u6b64\u8fdb\u884c\u524d\u7aef\u9759\u6001\u8d44\u6e90\u5206\u79bb\u3002", "top": 0, "createdAt": 1707885648, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-02-14", "dateLabelColor": "#bc4c00"}, "P1": {"htmlDir": "docs/post/ru-he-shi-xian-chao-guan-deng-lu.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u5982\u4f55\u5b9e\u73b0\u8d85\u7ba1\u767b\u5f55", "postUrl": "post/ru-he-shi-xian-chao-guan-deng-lu.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/1", "commentNum": 0, "wordCount": 526, "description": "\u5bf9\u4e8e ToC \u5e73\u53f0\uff0c\u968f\u7740\u63a5\u5165\u5e94\u7528\u7684\u589e\u52a0\uff0c\u7528\u6237\u53cd\u9988\u7684\u95ee\u9898\u4e5f\u53d8\u591a\uff0c\r\n\u65e5\u5fd7\u6ca1\u6709\u8bb0\u5f55\u5230\u7684\u8bdd\uff0c\u52a0\u4e0a\u73b0\u6709\u7684\u6743\u9650\u4f53\u7cfb\u4e0b\u67e5\u770b\u95ee\u9898\u4e0d\u65b9\u4fbf\uff0c\r\n\u5f88\u96be\u590d\u73b0\u95ee\u9898\uff0c\u9700\u8981\u4e00\u4e2a\u4e2a\u52a0\u5230\u5bf9\u5e94\u7684\u5e94\u7528\u4e2d\u3002", "top": 0, "createdAt": 1707972048, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-02-15", "dateLabelColor": "#bc4c00"}, "P5": {"htmlDir": "docs/post/Go -yu-yan-xia-ru-he-ti-jiao-bao-han-fan-yin-hao-de-duo-xing-zi-fu-chuan-biao-dan.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "Go \u8bed\u8a00\u4e0b\u5982\u4f55\u63d0\u4ea4\u5305\u542b\u53cd\u5f15\u53f7\u7684\u591a\u884c\u5b57\u7b26\u4e32\u8868\u5355", "postUrl": "post/Go%20-yu-yan-xia-ru-he-ti-jiao-bao-han-fan-yin-hao-de-duo-xing-zi-fu-chuan-biao-dan.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/5", "commentNum": 0, "wordCount": 245, "description": "\u611f\u89c9 Go \u8bed\u8a00\u5bf9\u4e8e\u591a\u884c\u5b57\u7b26\u4e32\u7684\u652f\u6301\u4e0d\u662f\u5f88\u53cb\u597d\u3002", "top": 0, "createdAt": 1713067054, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-04-14", "dateLabelColor": "#bc4c00"}, "P6": {"htmlDir": "docs/post/clickhouse-go -mou-xie-cha-xun-bu-hui-fan-hui-cha-xun-cuo-wu.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "clickhouse-go \u67d0\u4e9b\u67e5\u8be2\u4e0d\u4f1a\u8fd4\u56de\u67e5\u8be2\u9519\u8bef", "postUrl": "post/clickhouse-go%20-mou-xie-cha-xun-bu-hui-fan-hui-cha-xun-cuo-wu.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/6", "commentNum": 0, "wordCount": 1960, "description": "\u4f7f\u7528 [clickhouse-go](https://github.com/ClickHouse/clickhouse-go) \u4f5c\u4e3a\u5ba2\u6237\u7aef\u8fdb\u884c clickhouse \u67e5\u8be2\u65f6\uff0c\u53d1\u73b0\u67d0\u4e9b\u67e5\u8be2\u4e0d\u4f1a\u8fd4\u56de\u67e5\u8be2\u9519\u8bef\uff0c\r\n1. \u67e5\u8be2\u65f6\u95f4\u8d85\u8fc7\u6700\u5927\u67e5\u8be2\u65f6\u95f4\u53c2\u6570 (max_execution_time)\r\n2. \u975e\u6cd5\u67e5\u8be2\uff0c\u6bd4\u5982 sleep(300)\r\n\r\n\u4e0b\u9762\u7ed9\u793a\u4f8b\uff0c\r\n\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t'context'\r\n\t'fmt'\r\n\t'log'\r\n\r\n\t'github.com/ClickHouse/clickhouse-go/v2'\r\n)\r\n\r\nfunc main() {\r\n\tdb := clickhouse.OpenDB(&clickhouse.Options{\r\n\t\tAddr: []string{'127.0.0.1:9000'},\r\n\t\tAuth: clickhouse.Auth{\r\n\t\t\tDatabase: 'default',\r\n\t\t\tUsername: 'default',\r\n\t\t\tPassword: '',\r\n\t\t},\r\n\t\tSettings: clickhouse.Settings{\r\n\t\t\t'join_use_nulls': 1,\r\n\t\t},\r\n\t})\r\n\r\n\tctx := context.Background()\r\n\tconn, err := db.Conn(ctx)\r\n\tif err != nil {\r\n\t\tlog.Fatal(err)\r\n\t}\r\n\tdefer conn.Close()\r\n\r\n\tsql := 'select sleep(300)'\r\n\trows, err := conn.QueryContext(ctx, sql)\r\n\tif err != nil {\r\n\t\tlog.Fatal(err)\r\n\t}\r\n\tdefer rows.Close()\r\n\r\n\tfmt.Println(rows.Columns())\r\n}\r\n```\r\n\r\n\u671f\u671b\u7ed3\u679c\u662f\uff0c\r\n```\r\ncode: 160, message: The maximum sleep time is 3000000 microseconds. Requested: 300: while executing 'FUNCTION sleep(300 :: 0) -> sleep(300) UInt8 : 1'\r\n```\r\n\r\n\u6267\u884c\u7ed3\u679c\u662f\uff0c\r\n```\r\n[sleep(300)] <nil>\r\n```\r\n\r\n---\r\n\r\n\u95ee\u4e86\u5b98\u65b9\uff0c\u8bf4\u662f\uff0c\r\nSince the error is not thrown in ClickHouse at the time of query retrieval but later with the data packet, the client has to process data received from the server explicitly using rows.Next().\r\n\r\nSee code snippet:\r\n```go\r\npackage issues\r\n\r\nimport (\r\n\t'context'\r\n\t'testing'\r\n\r\n\tclickhouse_tests 'github.com/ClickHouse/clickhouse-go/v2/tests'\r\n\t'github.com/stretchr/testify/assert'\r\n\t'github.com/stretchr/testify/require'\r\n)\r\n\r\nfunc Test1268(t *testing.T) {\r\n\tconn, err := clickhouse_tests.GetDatabaseSQLConnection('issues', nil, nil, nil)\r\n\trequire.NoError(t, err)\r\n\r\n\trows, err := conn.QueryContext(context.Background(), 'select sleep(300)')\r\n\trequire.NoError(t, err)\r\n\tdefer rows.Close()\r\n\r\n\tfor rows.Next() {\r\n\t\tif rows.Err() != nil {\r\n\t\t\tbreak\r\n\t\t}\r\n\t}\r\n\r\n\tassert.ErrorContains(t, rows.Err(), 'code: 160, message: The maximum sleep time is 3000000 microseconds.')\r\n}\r\n```\u3002", "top": 0, "createdAt": 1713067207, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-04-14", "dateLabelColor": "#bc4c00"}, "P7": {"htmlDir": "docs/post/ru-he-zai- iOS -shang-an-zhuang- PokeMMO.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u5982\u4f55\u5728 iOS \u4e0a\u5b89\u88c5 PokeMMO", "postUrl": "post/ru-he-zai-%20iOS%20-shang-an-zhuang-%20PokeMMO.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/7", "commentNum": 0, "wordCount": 270, "description": "\u51c6\u5907\u6761\u4ef6\uff1a\r\n1.  [PokeMMO Account](https://pokemmo.com/en/)\r\n2. [AltStore](https://iosdroids.com/altstore/)\r\n3. [PokeMMO ROMS](https://iosdroids.com/pokemmo-ios/)\r\n\r\n\u627e\u4e86\u597d\u4e45\u603b\u7b97\u5728 [How to Download & Install PokeMMO on iOS?](https://iosdroids.com/pokemmo-ios/) \u627e\u5230\u53ef\u4e0b\u8f7d\u7684 PokeMMO ROMS.\r\n\u3002", "top": 0, "createdAt": 1713106547, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-04-14", "dateLabelColor": "#bc4c00"}, "P8": {"htmlDir": "docs/post/fen-xi-ping-tai-zhong-de-ye-wu-guan-xi-tu.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u5206\u6790\u5e73\u53f0\u4e2d\u7684\u4e1a\u52a1\u5173\u7cfb\u56fe", "postUrl": "post/fen-xi-ping-tai-zhong-de-ye-wu-guan-xi-tu.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/8", "commentNum": 0, "wordCount": 441, "description": "### \u7528\u6237\u548c\u5e94\u7528\u89d2\u8272\u4e4b\u95f4\u7684\u5173\u7cfb\r\n![user_role_permission](https://github.com/night1008/night1008.github.io/assets/3940006/214e5136-2ac8-453f-8ddb-e4cd865e4027)\r\n\r\n---\r\n\r\n### \u8868\u548c\u5c5e\u6027\u4e4b\u95f4\u7684\u5173\u7cfb\r\n![event_property](https://github.com/night1008/night1008.github.io/assets/3940006/33933ff6-4c26-434b-a190-3ed98f2b5bc9)\r\n\r\n\r\n---\r\n\r\n### \u770b\u677f\u7a7a\u95f4\u548c\u770b\u677f\u4e4b\u95f4\u7684\u5173\u7cfb\r\n![dashboard_space](https://github.com/night1008/night1008.github.io/assets/3940006/40200478-f311-40a1-ba05-1e3e0a80a394)\r\n\u3002", "top": 0, "createdAt": 1714036652, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-04-25", "dateLabelColor": "#bc4c00"}, "P9": {"htmlDir": "docs/post/Go -you-qu-de-dai-ma-pian-duan.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "Go \u6709\u8da3\u7684\u4ee3\u7801\u7247\u6bb5", "postUrl": "post/Go%20-you-qu-de-dai-ma-pian-duan.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/9", "commentNum": 0, "wordCount": 745, "description": "### \u53ef\u4ee5\u5bf9 error \u8fdb\u884c switch \u5224\u65ad\r\n\r\n\u6765\u6e90\uff1ahttps://github.com/prashanthpai/sqlcache/blob/4bf943bfd00f02394a480c5437e86af4b5be074c/cache_redis.go#L24\r\n\r\n```go\r\nfunc (r *Redis) Get(ctx context.Context, key string) (*cache.Item, bool, error) {\r\n\tb, err := r.c.Get(ctx, r.keyPrefix+key).Bytes()\r\n\tswitch err {\r\n\tcase nil:\r\n\t\tvar item cache.Item\r\n\t\tif err := msgpack.Unmarshal(b, &item); err != nil {\r\n\t\t\treturn nil, true, err\r\n\t\t}\r\n\t\treturn &item, true, nil\r\n\tcase redis.Nil:\r\n\t\treturn nil, false, nil\r\n\tdefault:\r\n\t\treturn nil, false, err\r\n\t}\r\n}\r\n```\r\n\r\n---\r\n\r\n### \u533f\u540d\u7ed3\u6784\u4f53\r\n\r\n\u6765\u6e90\uff1ahttps://quii.gitbook.io/learn-go-with-tests/go-fundamentals/concurrency#channels\r\n\r\n```go\r\ntype result struct {\r\n\tstring\r\n\tbool\r\n}\r\n\r\nvar r result\r\nfmt.Println(r.string, r.bool)\r\n```\u3002", "top": 0, "createdAt": 1717246865, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-01", "dateLabelColor": "#bc4c00"}, "P10": {"htmlDir": "docs/post/Go -ru-he-shi-xian- Clickhouse -cha-xun-huan-cun.html", "labels": ["\u5f00\u53d1"], "postTitle": "Go \u5982\u4f55\u5b9e\u73b0 Clickhouse \u67e5\u8be2\u7f13\u5b58", "postUrl": "post/Go%20-ru-he-shi-xian-%20Clickhouse%20-cha-xun-huan-cun.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/10", "commentNum": 0, "wordCount": 4539, "description": "**\u6574\u4f53\u601d\u8def\uff1a\u5148\u5224\u65ad\u662f\u5426\u547d\u4e2d\u7f13\u5b58\uff0c\u6ca1\u6709\u7684\u8bdd\u518d\u8fdb\u5165\u67e5\u8be2\u961f\u5217**\r\n\r\n\u4f9d\u8d56\u7684\u5305\r\n```\r\nhttps://github.com/ClickHouse/ClickHouse\r\n\r\nhttps://github.com/prashanthpai/sqlcache => https://github.com/night1008/sqlcache\r\n\r\nhttps://github.com/DATA-DOG/go-sqlmock\r\n\r\nhttps://github.com/blockloop/scan\r\n```\r\n\r\n\u73b0\u5728\u7684\u95ee\u9898\u662f clickhouse \u7684\u67e5\u8be2\u7ed3\u679c\u53ef\u80fd\u8fd4\u56de\u590d\u6742\u7c7b\u578b\uff0c\u6bd4\u5982 Map(String, UInt8)\uff0c\r\n\u5982\u679c\u547d\u4e2d\u7f13\u5b58\uff0c\u7f13\u5b58\u7684\u7ed3\u679c\u4e3a `driver.Rows`\uff0c\u9700\u8981\u8f6c\u6362\u6210 `*sql.Rows` \u65b9\u4fbf\u540e\u7eed\u4f7f\u7528\uff0c\r\n\u56e0\u6b64\u60f3\u5230\u901a\u8fc7 `sqlmock` \u7684\u65b9\u5f0f\uff0c\u4f46\u662f\u9ed8\u8ba4\u7684 `value converter` \u662f `driver.DefaultParameterConverter`\uff0c\u53ea\u80fd\u8f6c\u6362\u57fa\u7840\u7c7b\u578b\uff0c\r\n\u590d\u6742\u7c7b\u578b\u4e5f\u6ca1\u6709\u5b9a\u4e49\u4e13\u95e8\u7528\u4e8e\u89e3\u6790\u7684\u7ed3\u6784\u4f53\uff0c\u4f1a\u62a5\u8bf8\u5982\u4ee5\u4e0b\u7684\u9519\u8bef\uff0c\r\n\r\n> panic: row #1, column #2 ('mapper') type map[string]uint8: unsupported type map[string]uint8, a map\r\n\r\n\u597d\u5728 `go-sqlmock` \u53ef\u4ee5\u6307\u5b9a `ValueConverterOption`\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a `driver.Rows` \u8f6c\u6362\u6210 `*sql.Rows` \u4e86\u3002", "top": 0, "createdAt": 1717915402, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-09", "dateLabelColor": "#bc4c00"}, "P11": {"htmlDir": "docs/post/ru-he-shi-yong- GORM -chuang-jian-huo-zhe-geng-xin-shu-ju-ku-ji-lu.html", "labels": ["\u5f00\u53d1"], "postTitle": "\u5982\u4f55\u4f7f\u7528 GORM \u521b\u5efa\u6216\u8005\u66f4\u65b0\u6570\u636e\u5e93\u8bb0\u5f55", "postUrl": "post/ru-he-shi-yong-%20GORM%20-chuang-jian-huo-zhe-geng-xin-shu-ju-ku-ji-lu.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/11", "commentNum": 0, "wordCount": 1338, "description": "\u5199\u4e1a\u52a1\u8fc7\u7a0b\u4e2d\uff0c\u7ecf\u8fc7\u4f1a\u9047\u5230\u5f53\u6570\u636e\u4e0d\u5b58\u5728\u5219\u521b\u5efa\u8bb0\u5f55\uff0c\u5df2\u5b58\u5728\u5219\u66f4\u65b0\u8bb0\u5f55\u7684\u60c5\u51b5\uff0c\r\n\r\n\u4e00\u5f00\u59cb\u4f7f\u7528\u4e00\u4e0b\u4ee3\u7801\u4e2d\u7684\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff0c\u53d1\u73b0\u6ca1\u751f\u6548\uff0c\u540e\u9762\u6539\u6210\u7b2c\u4e8c\u79cd\u624d\u751f\u6548\uff0c\u5728\u6b64\u8bb0\u5f55\u4e00\u4e0b\u3002", "top": 0, "createdAt": 1719029544, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-22", "dateLabelColor": "#bc4c00"}, "P12": {"htmlDir": "docs/post/Go mod -ru-he-ti-huan- fork -de-bao-he-ban-ben.html", "labels": ["\u5f00\u53d1"], "postTitle": "Go mod \u5982\u4f55\u66ff\u6362 fork \u7684\u5305\u548c\u7248\u672c", "postUrl": "post/Go%20mod%20-ru-he-ti-huan-%20fork%20-de-bao-he-ban-ben.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/12", "commentNum": 0, "wordCount": 828, "description": "\u4ee5  `github.com/prashanthpai/sqlcache` \u4e3a\u4f8b\uff0c\u60f3\u66ff\u6362\u6210 fork \u7684\u5305 `github.com/night1008/sqlcache`\uff0c\r\n\u5047\u8bbe\u5f53\u524d\u8be5\u5305\u7684\u7248\u672c\u4e3a `v0.0.0`\r\n\r\n#### \u7b2c\u4e00\u6b65\r\n```\r\ngo mod edit -replace github.com/prashanthpai/sqlcache@v0.0.0=github.com/night1008/sqlcache@master\r\n```\r\n\r\n---\r\n\r\n#### \u7b2c\u4e8c\u6b65\r\n```\r\ngo get -u github.com/night1008/sqlcache\r\n```\r\n\r\n\u4f1a\u6709\u4ee5\u4e0b\u63d0\u793a\r\n```\r\ngo: downloading github.com/night1008/sqlcache v0.0.0-20240623031410-4d47c940a2d7\r\ngo: github.com/night1008/sqlcache@v0.0.0-20240623031410-4d47c940a2d7: parsing go.mod:\r\n\tmodule declares its path as: github.com/prashanthpai/sqlcache\r\n\t        but was required as: github.com/night1008/sqlcache\r\n```\r\n\r\n---\r\n\r\n#### \u7b2c\u4e09\u6b65\r\n\r\n\u624b\u52a8\u628a v0.0.0-20240623031410-4d47c940a2d7 \u66ff\u6362\u5230 go.mod `replace github.com/prashanthpai/sqlcache v0.0.0 => github.com/night1008/sqlcache master` \u8fd9\u4e00\u884c\u7684 master\r\n\r\n---\r\n\r\n#### \u7b2c\u56db\u6b65\r\n```\r\ngo mod tidy\r\n```\u3002", "top": 0, "createdAt": 1719384747, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-06-26", "dateLabelColor": "#bc4c00"}, "P13": {"htmlDir": "docs/post/Go -ru-he-shi-xian-shi-jian-fen-xi-fen-zu-pai-xu.html", "labels": ["\u5f00\u53d1"], "postTitle": "Go \u5982\u4f55\u5b9e\u73b0\u4e8b\u4ef6\u5206\u6790\u5206\u7ec4\u6392\u5e8f", "postUrl": "post/Go%20-ru-he-shi-xian-shi-jian-fen-xi-fen-zu-pai-xu.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/13", "commentNum": 0, "wordCount": 3121, "description": "\u4e8b\u4ef6\u5206\u6790\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u5bf9\u5206\u7ec4\u8fdb\u884c\u6392\u5e8f\uff0c\u6709\u5982\u4e0b\u7684\u6392\u5e8f\u89c4\u5219\uff0c\r\n\r\n1. \u6309\u7b2c\u4e00\u4e2a\u6307\u6807\u503c\u7684\u6b63\u5e8f\u6392\u5217\r\n2. \u6309\u7b2c\u4e00\u4e2a\u6307\u6807\u503c\u7684\u5012\u5e8f\u6392\u5217\r\n3. \u6309\u5206\u7ec4\u503c\u7684\u6b63\u5e8f\u6392\u5217\r\n4. \u6309\u5206\u7ec4\u503c\u7684\u5012\u5e8f\u6392\u5217\r\n\r\n\u5206\u7ec4\u662f `[][]string` \u7c7b\u578b\uff0c\u503c\u662f `float64` \u7c7b\u578b\uff0c\r\n\r\n\u4e0b\u9762\u8bb0\u5f55\u4e0b\u4e3b\u8981\u7684\u6392\u5e8f\u4ee3\u7801\r\n\r\n```go\r\nconst (\r\n\tPropertyTypeInteger              = 'integer'                // \u6574\u6570\u7c7b\u578b\r\n\tPropertyTypeFloat                = 'float'                  // \u6d6e\u70b9\u7c7b\u578b\uff0c\u5bf9\u5e94 float64 \u6216 double\r\n\tPropertyTypeNumber               = 'number'                 // \u6d6e\u70b9\u7c7b\u578b\uff0c\u5bf9\u5e94 float64 \u6216 double\r\n)\r\n\r\ntype EventModelQueryGroupBy struct {\r\n\tName              string    `json:'name' example:'_time'`\r\n\tType              string    `json:'type' example:'timestamp'`\r\n\tTitle             string    `json:'title' example:'\u4e8b\u4ef6\u53d1\u751f\u65f6\u95f4'`\r\n\tTableType         string    `json:'table_type' example:'event'`\r\n\tMetaType          string    `json:'meta_type' example:'custom'`\r\n}\r\n\r\n// \u6839\u636e\u5206\u7ec4\u503c\u6392\u5e8f\r\nfunc sortUnionGroupsByValue(unionGroups [][]string, unionGroupsValueMap map[string]float64, unionGroupsJoinSymbol string, sortByAsc bool) [][]string {\r\n\tnewUnionGroups := make([][]string, len(unionGroups))\r\n\tcopy(newUnionGroups, unionGroups)\r\n\tsort.Slice(newUnionGroups, func(i, j int) bool {\r\n\t\tsortValue := false\r\n\t\tif sortByAsc {\r\n\t\t\tsortValue = unionGroupsValueMap[strings.Join(newUnionGroups[i], unionGroupsJoinSymbol)] < unionGroupsValueMap[strings.Join(newUnionGroups[j], unionGroupsJoinSymbol)]\r\n\t\t} else {\r\n\t\t\tsortValue = unionGroupsValueMap[strings.Join(newUnionGroups[i], unionGroupsJoinSymbol)] > unionGroupsValueMap[strings.Join(newUnionGroups[j], unionGroupsJoinSymbol)]\r\n\t\t}\r\n\t\treturn sortValue\r\n\t})\r\n\treturn newUnionGroups\r\n}\r\n\r\n// \u6839\u636e\u5206\u7ec4\u540d\u79f0\u6392\u5e8f\r\nfunc sortUnionGroupsByGroup(unionGroups [][]string, unionGroupBy []*EventModelQueryGroupBy, sortByAsc bool) [][]string {\r\n\tnewUnionGroups := make([][]string, len(unionGroups))\r\n\tcopy(newUnionGroups, unionGroups)\r\n\tsort.Slice(newUnionGroups, func(i, j int) bool {\r\n\t\tsortValue := false\r\n\t\tfor index := range unionGroupBy {\r\n\t\t\tif newUnionGroups[i][index] != newUnionGroups[j][index] {\r\n\t\t\t\tswitch unionGroupBy[index].Type {\r\n\t\t\t\tcase PropertyTypeInteger, PropertyTypeNumber:\r\n\t\t\t\t\tif sortByAsc {\r\n\t\t\t\t\t\tsortValue = sortValue || parseNumberRangeSortValue(newUnionGroups[i][index]) < parseNumberRangeSortValue(newUnionGroups[j][index])\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsortValue = sortValue || parseNumberRangeSortValue(newUnionGroups[i][index]) > parseNumberRangeSortValue(newUnionGroups[j][index])\r\n\t\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif sortByAsc {\r\n\t\t\t\t\t\tsortValue = sortValue || newUnionGroups[i][index] < newUnionGroups[j][index]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsortValue = sortValue || newUnionGroups[i][index] > newUnionGroups[j][index]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn sortValue\r\n\t})\r\n\treturn newUnionGroups\r\n}\r\n\r\n// \u5bf9\u6570\u503c\u7c7b\u578b\u5206\u7ec4\u503c\u62c6\u5206\u5f97\u5230\u6392\u5e8f\u503c [-\u221e, 100), [-1, 2), 100, (null)\r\nfunc parseNumberRangeSortValue(valueStr string) float64 {\r\n\tfirstPartValue := strings.SplitN(valueStr, ',', 2)[0]\r\n\tfirstPartValue = strings.TrimLeft(firstPartValue, '[')\r\n\tswitch firstPartValue {\r\n\tcase '-\u221e':\r\n\t\treturn math.Inf(-1)\r\n\tcase '(null)':\r\n\t\treturn math.NaN()\r\n\tdefault:\r\n\t\tvalue, err := strconv.ParseFloat(firstPartValue, 64)\r\n\t\tif err != nil {\r\n\t\t\treturn math.Inf(-1)\r\n\t\t}\r\n\t\treturn value\r\n\t}\r\n}\r\n```\u3002", "top": 0, "createdAt": 1720076463, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-04", "dateLabelColor": "#bc4c00"}, "P14": {"htmlDir": "docs/post/Go recover from panic.html", "labels": ["\u5f00\u53d1"], "postTitle": "Go recover from panic", "postUrl": "post/Go%20recover%20from%20panic.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/14", "commentNum": 0, "wordCount": 479, "description": "```go\r\npackage main\r\n\r\nimport (\r\n\t'fmt'\r\n\t'runtime/debug'\r\n\t'time'\r\n\r\n\t'github.com/rs/zerolog/log'\r\n)\r\n\r\nfunc Recover() {\r\n\tif r := recover(); r != nil {\r\n\t\tdebugStack := string(debug.Stack())\r\n\t\tfmt.Println(debugStack)\r\n\t\tlog.Error().Err(fmt.Errorf('%s', debugStack)).Msg('recover from panic')\r\n\t}\r\n}\r\n\r\nfunc main() {\r\n\tgo func() {\r\n\t\tdefer Recover()\r\n\t\tvar ss []string\r\n\t\tfmt.Println(ss[1])\r\n\t}()\r\n\r\n\ttime.Sleep(100 * time.Millisecond)\r\n\r\n\tfmt.Println('===> enter end')\r\n}\r\n```\u3002", "top": 0, "createdAt": 1720171836, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-05", "dateLabelColor": "#bc4c00"}, "P15": {"htmlDir": "docs/post/kan-guo-de-dian-ying-he-ji.html", "labels": ["\u751f\u6d3b"], "postTitle": "\u770b\u8fc7\u7684\u7535\u5f71\u5408\u96c6", "postUrl": "post/kan-guo-de-dian-ying-he-ji.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/15", "commentNum": 0, "wordCount": 995, "description": "\u7535\u5f71\u94fe\u63a5\u5230 [\u8c46\u74e3\u7535\u5f71](https://movie.douban.com)\r\n---\r\n\r\n- [ ] [\u4e5d\u9f99\u57ce\u5be8\u4e4b\u56f4\u57ce](https://movie.douban.com/subject/24284175) (\u4e00\u822c)\r\n- [ ] [\u5e74\u4f1a\u4e0d\u80fd\u505c](https://movie.douban.com/subject/35725869) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u4e09\u5927\u961f](https://movie.douban.com/subject/35208463) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u5b64\u6ce8\u4e00\u63b7](https://movie.douban.com/subject/35267224) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u7011\u5e03](https://movie.douban.com/subject/35242938) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u5468\u5904\u9664\u4e09\u5bb3](https://movie.douban.com/subject/36151692) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u8001\u72d0\u72f8](https://movie.douban.com/subject/35611467) (\u4e0d\u9519)\r\n- [ ] [\u7834\u5893](https://movie.douban.com/subject/35490167) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u9996](https://movie.douban.com/subject/35359717) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u6c99\u4e181](https://movie.douban.com/subject/3001114) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u6c99\u4e182](https://movie.douban.com/subject/35575567) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u6708\u6ee1\u8f69\u5c3c\u8bd7](https://movie.douban.com/subject/3777800) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u56e0\u679c\u62a5\u5e94 Maharaja](https://movie.douban.com/subject/36934908/) (\u8fd8\u4e0d\u9519)\r\n- [ ] [\u5fc3\u91cc\u7684\u58f0\u97f3](https://movie.douban.com/subject/26435723/) (\u8fd8\u53ef\u4ee5)\r\n- [ ] [\u6912\u9ebb\u5802\u4f1a](https://movie.douban.com/subject/27305997/) (\u6709\u70b9\u610f\u601d)\u3002", "top": 0, "createdAt": 1720277993, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-07-06", "dateLabelColor": "#bc4c00"}, "P16": {"htmlDir": "docs/post/Clickhouse -liu-cun-fen-xi-zhong-ru-he-ji-suan-fen-xi-zhu-ti-de-liu-shi-shu.html", "labels": ["\u5f00\u53d1"], "postTitle": "Clickhouse \u7559\u5b58\u5206\u6790\u4e2d\u5982\u4f55\u8ba1\u7b97\u5206\u6790\u4e3b\u4f53\u7684\u6d41\u5931\u6570", "postUrl": "post/Clickhouse%20-liu-cun-fen-xi-zhong-ru-he-ji-suan-fen-xi-zhu-ti-de-liu-shi-shu.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/16", "commentNum": 0, "wordCount": 2376, "description": "### \u80cc\u666f\r\n\r\n\u5148\u660e\u786e\u7559\u5b58\u5206\u6790\u76f8\u5173\u7684\u6982\u5ff5\r\n**\u7559\u5b58\u5206\u6790**\uff1a\u8861\u91cf\u4e0d\u540c\u6279\u6b21\u65b0\u589e\u7528\u6237\u7684\u6570\u636e\u8868\u73b0\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u7559\u5b58\u7387\r\n**\u5206\u6790\u4e3b\u4f53**\uff1a\u89e6\u53d1\u4e8b\u4ef6\u7684\u4e3b\u4f53\uff0c\u6bd4\u5982\u7528\u6237\r\n**\u521d\u59cb\u4e8b\u4ef6**\uff1a\u4ee3\u8868\u65b0\u589e\u7684\u4e8b\u4ef6\uff0c\u6bd4\u5982\u7528\u6237\u6ce8\u518c\r\n**\u56de\u8bbf\u4e8b\u4ef6**\uff1a\u4ee3\u8868\u6d3b\u8dc3\u7684\u4e8b\u4ef6\uff0c\u6bd4\u5982\u7528\u6237\u767b\u5f55\r\n\r\n---\r\n\r\n### \u9700\u6c42\r\n\r\n\u4ea7\u54c1\u7ed9\u51fa\u7684\u6d41\u5931\u5b9a\u4e49\u4e3a\uff1a\u67d0\u5929\u5b8c\u6210\u4e86\u521d\u59cb\u4e8b\u4ef6\u7684\u5206\u6790\u4e3b\u4f53\uff0c\u5728\u521d\u59cb\u4e8b\u4ef6\u65e5\u671f\u540e\u7684\u7b2c 1 \u65e5\u81f3\u7b2c N \u65e5\u90fd\u6ca1\u6709\u5b8c\u6210\u201c\u56de\u8bbf\u4e8b\u4ef6\u201d\uff0c\u5373\u4e3a\u7b2c N \u65e5\u7684\u201c\u6d41\u5931\u7528\u6237\u201d\u3002", "top": 0, "createdAt": 1724055907, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-08-19", "dateLabelColor": "#bc4c00"}, "P17": {"htmlDir": "docs/post/Clickhouse -liu-cun-fen-xi-zhong-ru-he-ji-suan-fen-xi-zhu-ti-de-liu-cun-qing-kuang.html", "labels": ["\u5f00\u53d1"], "postTitle": "Clickhouse \u7559\u5b58\u5206\u6790\u4e2d\u5982\u4f55\u8ba1\u7b97\u5206\u6790\u4e3b\u4f53\u7684\u7559\u5b58\u60c5\u51b5", "postUrl": "post/Clickhouse%20-liu-cun-fen-xi-zhong-ru-he-ji-suan-fen-xi-zhu-ti-de-liu-cun-qing-kuang.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/17", "commentNum": 0, "wordCount": 3434, "description": "## \u80cc\u666f\r\n\r\n\u5148\u660e\u786e\u7559\u5b58\u5206\u6790\u76f8\u5173\u7684\u6982\u5ff5\uff0c\r\n**\u7559\u5b58\u5206\u6790**\uff1a\u8861\u91cf\u4e0d\u540c\u6279\u6b21\u65b0\u589e\u7528\u6237\u7684\u6570\u636e\u8868\u73b0\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u7559\u5b58\u7387\r\n**\u5206\u6790\u4e3b\u4f53**\uff1a\u89e6\u53d1\u4e8b\u4ef6\u7684\u4e3b\u4f53\uff0c\u6bd4\u5982\u7528\u6237\r\n**\u521d\u59cb\u4e8b\u4ef6**\uff1a\u4ee3\u8868\u65b0\u589e\u7684\u4e8b\u4ef6\uff0c\u6bd4\u5982\u7528\u6237\u6ce8\u518c\r\n**\u56de\u8bbf\u4e8b\u4ef6**\uff1a\u4ee3\u8868\u6d3b\u8dc3\u7684\u4e8b\u4ef6\uff0c\u6bd4\u5982\u7528\u6237\u767b\u5f55\r\n**\u56de\u8bbf\u7528\u6237\u540c\u65f6\u53c2\u4e0e\u4e8b\u4ef6**\uff1a\u4ee3\u8868\u6d3b\u8dc3\u7684\u4e8b\u4ef6\uff0c\u6bd4\u5982\u7528\u6237\u5145\u503c\r\n\r\n## \u9700\u6c42\r\n\r\n\u4ea7\u54c1\u7ed9\u51fa\u7684\u5173\u4e8e\u7559\u5b58\u5b9a\u4e49\u4e3a\uff1a**\u67d0\u5929\u5b8c\u6210\u4e86\u521d\u59cb\u4e8b\u4ef6\u7684\u5206\u6790\u4e3b\u4f53\uff0c\u5728\u521d\u59cb\u4e8b\u4ef6\u65e5\u671f\u540e\u7684\u7b2c 1 \u65e5\u81f3\u7b2c N \u65e5\u6709\u5b8c\u6210\u201c\u56de\u8bbf\u4e8b\u4ef6\u201d\uff0c\u5373\u4e3a\u7b2c N \u65e5\u7684\u201c\u7559\u5b58\u7528\u6237\u201d**\u3002", "top": 0, "createdAt": 1726134578, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-09-12", "dateLabelColor": "#bc4c00"}, "P18": {"htmlDir": "docs/post/ru-he-tong-guo-shu-ju-ku-quan-ju-suo-fang-shi-shi-xian-ren-wu-dan-jie-dian-zhi-xing.html", "labels": ["\u5f00\u53d1"], "postTitle": "\u5982\u4f55\u901a\u8fc7\u6570\u636e\u5e93\u5168\u5c40\u9501\u65b9\u5f0f\u5b9e\u73b0\u4efb\u52a1\u5355\u8282\u70b9\u6267\u884c", "postUrl": "post/ru-he-tong-guo-shu-ju-ku-quan-ju-suo-fang-shi-shi-xian-ren-wu-dan-jie-dian-zhi-xing.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/18", "commentNum": 0, "wordCount": 2976, "description": "\u901a\u8fc7 `postgres` \u7684\u6570\u636e\u5e93\u884c\u7ea7\u522b\u7684\u9501\u673a\u5236\u5168\u5c40\u63a7\u5236\u6240\u6709\u7684\u4efb\u52a1\u53ea\u5728\u67d0\u4e2a\u8282\u70b9\u4e0a\u6267\u884c\r\n\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t'context'\r\n\t'errors'\r\n\t'log'\r\n\t'time'\r\n\r\n\t'github.com/jackc/pgconn'\r\n\t'golang.org/x/sync/errgroup'\r\n\t'gorm.io/driver/postgres'\r\n\t'gorm.io/gorm'\r\n\t'gorm.io/gorm/clause'\r\n\t'gorm.io/gorm/logger'\r\n)\r\n\r\nconst (\r\n\tglobalJobLockGetPollingDuration = time.Second // \u5168\u5c40\u4efb\u52a1\u9501\u8f6e\u8be2\u65f6\u95f4\r\n\r\n\tServiceDeploymentNameGlobalJobLock = 'global-job-lock' // \u5168\u5c40\u4efb\u52a1\u9501\r\n)\r\n\r\ntype ServiceDeployment struct {\r\n\tName string `gorm:'primarykey'` // \u670d\u52a1\u540d\u79f0\r\n\r\n\tCreatedAt int64 `gorm:'autoCreateTime:milli'` // \u8bb0\u5f55\u521b\u5efa\u65f6\u95f4\uff0c\u5355\u4f4d milli\r\n\tUpdatedAt int64 `gorm:'autoUpdateTime:milli'` // \u8bb0\u5f55\u66f4\u65b0\u65f6\u95f4\uff0c\u5355\u4f4d milli\r\n}\r\n\r\nfunc main() {\r\n\tdsn := 'host=localhost user=postgres password=secret dbname=test port=5432 sslmode=disable'\r\n\tdb, err := gorm.Open(postgres.Open(dsn), &gorm.Config{})\r\n\tif err != nil {\r\n\t\tlog.Fatal(err)\r\n\t}\r\n\tif err := db.AutoMigrate(&ServiceDeployment{}); err != nil {\r\n\t\tlog.Fatal(err)\r\n\t}\r\n\r\n\tvar jobEnable bool\r\n\r\n\teg, ctx := errgroup.WithContext(context.Background())\r\n\teg.Go(func() error {\r\n\t\tticker := time.NewTicker(globalJobLockGetPollingDuration)\r\n\t\tdefer ticker.Stop()\r\n\r\n\t\tfor {\r\n\t\t\texist, err := GetGlobalJobLock(db)\r\n\t\t\tif err != nil {\r\n\t\t\t\tlog.Println(err)\r\n\t\t\t}\r\n\t\t\tif exist {\r\n\t\t\t\tjobEnable = true\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\r\n\t\t\tselect {\r\n\t\t\tcase <-ctx.Done():\r\n\t\t\t\treturn ctx.Err()\r\n\t\t\tcase <-ticker.C:\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn nil\r\n\t})\r\n\r\n\teg.Go(func() error {\r\n\t\tif err := stopTickerUntil(ctx, globalJobLockGetPollingDuration, func() bool {\r\n\t\t\treturn jobEnable\r\n\t\t}); err != nil {\r\n\t\t\treturn err\r\n\t\t}\r\n\t\treturn RunJob(ctx)\r\n\t})\r\n\r\n\tif err := eg.Wait(); err != nil {\r\n\t\tlog.Println(err)\r\n\t}\r\n}\r\n\r\nfunc FindOne(db *gorm.DB, out interface{}) (bool, error) {\r\n\tresult := db.First(out)\r\n\tif err := result.Error; err != nil {\r\n\t\tif errors.Is(err, gorm.ErrRecordNotFound) {\r\n\t\t\treturn false, nil\r\n\t\t}\r\n\t\treturn false, err\r\n\t}\r\n\treturn true, nil\r\n}\r\n\r\nfunc GetGlobalJobLock(db *gorm.DB) (bool, error) {\r\n\tdeployment := ServiceDeployment{\r\n\t\tName: ServiceDeploymentNameGlobalJobLock,\r\n\t}\r\n\tif err := db.FirstOrCreate(&deployment, ServiceDeployment{Name: ServiceDeploymentNameGlobalJobLock}).Error; err != nil {\r\n\t\treturn false, err\r\n\t}\r\n\r\n\ttx := db.Session(&gorm.Session{Logger: logger.Discard}).Begin() // \u4e0d\u6253\u5370\u9519\u8bef\u65e5\u5fd7\uff0c\u62ff\u5230\u9501\u4f1a\u5360\u7528\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\r\n\texist, err := FindOne(tx.Clauses(clause.Locking{Strength: 'UPDATE', Options: 'NOWAIT'}).Where('name = ?', ServiceDeploymentNameGlobalJobLock), &deployment)\r\n\tif err != nil {\r\n\t\tif pgErr, ok := err.(*pgconn.PgError); ok && pgErr.Code == '55P03' {\r\n\t\t\terr = nil\r\n\t\t}\r\n\t\t_ = tx.Rollback()\r\n\t}\r\n\treturn exist, err\r\n}\r\n\r\nfunc stopTickerUntil(ctx context.Context, duration time.Duration, stopFunc func() bool) error {\r\n\tticker := time.NewTicker(duration)\r\n\tdefer ticker.Stop()\r\n\r\nLoop:\r\n\tfor {\r\n\t\tselect {\r\n\t\tcase <-ctx.Done():\r\n\t\t\treturn ctx.Err()\r\n\t\tcase <-ticker.C:\r\n\t\t\tif stopFunc() {\r\n\t\t\t\tbreak Loop\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nil\r\n}\r\n\r\nfunc RunJob(ctx context.Context) error {\r\n\t// run job\r\n\treturn nil\r\n}\r\n```\u3002", "top": 0, "createdAt": 1727420508, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-09-27", "dateLabelColor": "#bc4c00"}, "P19": {"htmlDir": "docs/post/Clickhouse -ru-he-shi-xian- LTV -fen-xi.html", "labels": ["\u5f00\u53d1"], "postTitle": "Clickhouse \u5982\u4f55\u5b9e\u73b0 LTV \u5206\u6790", "postUrl": "post/Clickhouse%20-ru-he-shi-xian-%20LTV%20-fen-xi.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/19", "commentNum": 0, "wordCount": 16649, "description": "### \u80cc\u666f\r\n\r\nLTV \u662f Life Time Value \u7f29\u5199\uff0c\u5373\u7528\u6237\u5728\u751f\u547d\u5468\u671f\u4e2d\u8d21\u732e\u7684\u5546\u4e1a\u4ef7\u503c\u3002", "top": 0, "createdAt": 1728441690, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-10-09", "dateLabelColor": "#bc4c00"}, "P20": {"htmlDir": "docs/post/PostgreSQL -chi-you-xing-ji-bie-suo-hou-biao-zi-duan-bian-geng-shi-bai-de-wen-ti.html", "labels": ["\u5f00\u53d1"], "postTitle": "PostgreSQL \u6301\u6709\u884c\u7ea7\u522b\u9501\u540e\u8868\u5b57\u6bb5\u53d8\u66f4\u5931\u8d25\u7684\u95ee\u9898", "postUrl": "post/PostgreSQL%20-chi-you-xing-ji-bie-suo-hou-biao-zi-duan-bian-geng-shi-bai-de-wen-ti.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/20", "commentNum": 0, "wordCount": 1492, "description": "### \u80cc\u666f\r\n\r\n\u6211\u4eec\u4f7f\u7528\u4e86 `PostgreSQL` \u8868\u7684\u8bb0\u5f55\u4f5c\u4e3a\u4efb\u52a1\u53ea\u5728\u5355\u4e2a\u8282\u70b9\u4e0a\u6267\u884c\u7684\u5168\u5c40\u9501\uff0c\r\n\u5e76\u4e14\u4f7f\u7528\u7684\u662f `FOR UPDATE` \u7684\u884c\u7ea7\u522b\u9501\uff0c\r\n\u4f46\u5728\u9501\u5df2\u88ab\u8868\u6301\u6709\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u8981\u5bf9\u8868\u7ed3\u6784\u8fdb\u884c\u53d8\u66f4\u5b57\u6bb5\u7684\u8bdd\uff0c\u4f1a\u6267\u884c\u5931\u8d25\uff0c\r\n\u573a\u666f\u4e3a\u65e7\u90e8\u7f72\u670d\u52a1\u5df2\u6301\u6709\u4e86\u884c\u7ea7\u522b\u9501\uff0c\u65b0\u90e8\u7f72\u670d\u52a1\u5c31\u53d8\u66f4\u4e0d\u4e86\u8868\u7ed3\u6784\uff0c\r\n\u56e0\u4e3a DDL \u64cd\u4f5c\uff08\u5982\u6dfb\u52a0\u5217\uff09\u4f1a\u5bf9\u6574\u4e2a\u8868\u52a0\u9501\uff0c\u8fd9\u4e24\u8005\u53d1\u751f\u4e86\u51b2\u7a81\u3002", "top": 0, "createdAt": 1728554364, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-10-10", "dateLabelColor": "#bc4c00"}, "P21": {"htmlDir": "docs/post/guan-yu- Golang viper mapstructure -fan-xu-lie-hua-duo-ci-shu-zu-lei-xing-shu-chu-cuo-wu.html", "labels": ["\u5f00\u53d1"], "postTitle": "\u5173\u4e8e Golang viper mapstructure \u53cd\u5e8f\u5217\u5316\u591a\u6b21\u6570\u7ec4\u7c7b\u578b\u8f93\u51fa\u9519\u8bef", "postUrl": "post/guan-yu-%20Golang%20viper%20mapstructure%20-fan-xu-lie-hua-duo-ci-shu-zu-lei-xing-shu-chu-cuo-wu.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/21", "commentNum": 0, "wordCount": 1833, "description": "\u4e1a\u52a1\u7a0b\u5e8f\u4f7f\u7528\u4e86 Golang \u4e2d\u7684 [viper](github.com/spf13/viper) \u8fdb\u884c\u52a0\u8f7d\u914d\u7f6e\uff0c\r\n\u4f46\u5728\u5b9e\u9645\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u56e0\u4e3a\u8bfb\u53d6\u4e86\u4e24\u6b21\u914d\u7f6e\uff0c\u540c\u65f6\u53cd\u5e8f\u5217\u5316\u4e86\u4e24\u6b21\uff0c\r\n\u5bfc\u81f4\u4e00\u4e9b\u6570\u7ec4\u7c7b\u578b\u7684\u5b57\u6bb5\u51fa\u73b0\u4e86\u4e0d\u7b26\u5408\u9884\u671f\u7684\u7ed3\u679c\uff0c\u5982\u4e0b\u6d4b\u8bd5\u7a0b\u5e8f\u6240\u793a\u3002", "top": 0, "createdAt": 1730429772, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-11-01", "dateLabelColor": "#bc4c00"}, "P22": {"htmlDir": "docs/post/Go web application packages.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "Go web application packages", "postUrl": "post/Go%20web%20application%20packages.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/22", "commentNum": 0, "wordCount": 324, "description": "1. [github.com/gin-gonic/gin](https://github.com/gin-gonic/gin) (framework)\r\n2. [github.com/spf13/cobra](https://github.com/spf13/cobra) (cli)\r\n3. [github.com/spf13/viper](https://github.com/spf13/viper) (config)\r\n4. [gorm.io/gorm](https://gorm.io/gorm) (orm)\r\n5. [github.com/rs/zerolog](https://github.com/rs/zerolog) (log)\u3002", "top": 0, "createdAt": 1731477283, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-11-13", "dateLabelColor": "#bc4c00"}, "P23": {"htmlDir": "docs/post/Go Gorm -ru-he-cha-xun-dong-tai-zi-duan-lie-biao-qie-neng-geng-xin-cha-xun-hou-de-jie-guo-shu-ju.html", "labels": ["\u5f00\u53d1"], "postTitle": "Go Gorm \u5982\u4f55\u67e5\u8be2\u52a8\u6001\u5b57\u6bb5\u5217\u8868\u4e14\u80fd\u66f4\u65b0\u67e5\u8be2\u540e\u7684\u7ed3\u679c\u6570\u636e", "postUrl": "post/Go%20Gorm%20-ru-he-cha-xun-dong-tai-zi-duan-lie-biao-qie-neng-geng-xin-cha-xun-hou-de-jie-guo-shu-ju.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/23", "commentNum": 0, "wordCount": 8620, "description": "### \u80cc\u666f\r\n\r\n\u6700\u8fd1\u5e7f\u544a\u4e1a\u52a1\u4e0a\u7684\u4e00\u4e9b\u62a5\u8868\u67e5\u8be2\u63a5\u53e3\uff0c\u9700\u8981\u6839\u636e\u524d\u7aef\u6307\u5b9a\u7684\u5b57\u6bb5\u5217\u8868\u8fd4\u56de\u67e5\u8be2\u805a\u5408\u7ed3\u679c\uff0c\u5176\u4e2d\u67d0\u4e9b\u5b57\u6bb5\u4e0d\u65b9\u4fbf\u5728\u6570\u636e\u5e93\u4e2d\u76f4\u63a5\u67e5\u8be2\u5f97\u5230\uff0c\u9700\u8981\u7ecf\u8fc7\u670d\u52a1\u7aef\u4e8c\u6b21\u8ba1\u7b97\uff0c\u624d\u80fd\u5f97\u5230\u6700\u7ec8\u7ed3\u679c\u3002", "top": 0, "createdAt": 1732851008, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-11-29", "dateLabelColor": "#bc4c00"}, "P24": {"htmlDir": "docs/post/fen-bu-shi-ren-wu-diao-du-she-ji-yao-dian.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u5206\u5e03\u5f0f\u4efb\u52a1\u8c03\u5ea6\u8bbe\u8ba1\u8981\u70b9", "postUrl": "post/fen-bu-shi-ren-wu-diao-du-she-ji-yao-dian.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/24", "commentNum": 0, "wordCount": 426, "description": "\u8bbe\u8ba1\u8981\u70b9\uff1a\r\n1. \u4efb\u52a1\u51fd\u6570\u6ce8\u518c\u65b9\u4fbf\uff0c\u53c2\u8003 http \u51fd\u6570\u6ce8\u518c\r\n2. \u4efb\u52a1\u521b\u5efa\u53ef\u4ee5\u6307\u5b9a\u53c2\u6570\uff0c\u6bd4\u5982\u91cd\u8bd5\u6b21\u6570\uff0c\u5ef6\u8fdf\u6267\u884c\uff0c\u8d85\u65f6\u65f6\u95f4\u7b49\r\n3. \u4efb\u52a1\u53ef\u4ee5\u5206\u961f\u5217\uff0c\u907f\u514d\u963b\u585e\uff0c\u6bd4\u5982\u9ad8\u4e2d\u4f4e\u4f18\u5148\u7ea7\r\n4. \u4efb\u52a1\u6267\u884c worker \u6570\u91cf\u53ef\u4ee5\u4efb\u610f\u6269\u5c55\r\n5. \u652f\u6301\u6307\u5b9a\u5b9a\u65f6\u4efb\u52a1\uff0c\u5b9a\u65f6\u4efb\u52a1\u7684\u4ea7\u751f\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u5e93\u751f\u6210\uff0c\u8fd9\u6837\u65b9\u4fbf\u4fee\u6539\u4efb\u52a1\u4fe1\u606f\r\n6. \u76f8\u540c\u5b9a\u65f6\u4efb\u52a1\u53ef\u4ee5\u6307\u5b9a\u4e0d\u540c\u5b9a\u65f6\u65f6\u95f4\uff0c\u4e0d\u540c\u65f6\u533a\r\n\r\n\u56e0\u4e3a\u4e1a\u52a1\u4e0a\u6709\u5b9a\u65f6\u4efb\u52a1\u7684\u573a\u666f\uff0c\u4e4b\u524d\u601d\u8003\u5982\u4f55\u4f7f\u7528 redis \u8fbe\u5230\u4e0a\u9762\u7684\u8bbe\u8ba1\u8981\u70b9\u65f6\uff0c\u4e00\u76f4\u6ca1\u60f3\u901a\u600e\u4e48\u505a\uff0c  \r\n\u76f4\u5230\u770b\u5230 https://github.com/hibiken/asynq \u7684\u5b9e\u73b0\uff0c\u6ca1\u60f3\u5230\u53ef\u4ee5\u901a\u8fc7\u5916\u90e8\u5b9a\u65f6\u5668\u53d1\u9001\u5b9a\u65f6\u4efb\u52a1\u7684\u65b9\u5f0f\u8fbe\u5230\u6548\u679c\u3002", "top": 0, "createdAt": 1734590903, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-12-19", "dateLabelColor": "#bc4c00"}, "P25": {"htmlDir": "docs/post/PostgreSQL -ye-wu-shi-yong-shou-ce.html", "labels": ["\u5f00\u53d1"], "postTitle": "PostgreSQL \u4e1a\u52a1\u4f7f\u7528\u624b\u518c", "postUrl": "post/PostgreSQL%20-ye-wu-shi-yong-shou-ce.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/25", "commentNum": 0, "wordCount": 1688, "description": "### \u624b\u52a8\u4fee\u6539\u8054\u5408\u4e3b\u952e\u8868\u7d22\u5f15\n\n\u539f\u672c `ad_advertisers` \u8868\u4ee5 `app_id`, `channel_name`, `account_id` \u4e09\u4e2a\u5b57\u6bb5\u4e3a\u4e3b\u952e\uff0c\u73b0\u5728\u5982\u4f55\u5f80\u4e2d\u95f4\u518d\u52a0\u4e00\u4e2a\u4e3b\u952e\u5b57\u6bb5\n\n```sql\nCREATE UNIQUE INDEX ad_advertisers_pkey ON public.ad_advertisers USING btree (app_id, channel_name, account_id);\n\n=>\n\nALTER TABLE public.ad_advertisers DROP CONSTRAINT ad_advertisers_pkey;\nUPDATE ad_advertisers SET account_type = '' WHERE account_type IS NULL;\nALTER TABLE public.ad_advertisers ADD CONSTRAINT ad_advertisers_pkey PRIMARY KEY (app_id, channel_name, account_type, account_id);\n```\n\n---\n\n### \u91cd\u7f6e\u6570\u636e\u5e93\u8868 ID\n\n```sql\nALTER SEQUENCE users_id_seq RESTART WITH 7;\n```\n\n---\n\n### \u67e5\u770b\u8868\u7ed3\u6784\n\n```sql\npg_dump -h localhost -p 5432 -U postgres -d db_name -t table_name --schema-only\n```\n\n---\n\n### \u8868\u5927\u5c0f\u60c5\u51b5\u67e5\u8be2\n\n```sql\n-- \u67e5\u770b\u6bcf\u4e2a\u8868\u7684\u5360\u7528\u7a7a\u95f4\u5927\u5c0f\nselect\n\u00a0 table_name,\u00a0\n\u00a0 pg_size_pretty(pg_total_relation_size(quote_ident(table_name))),\n\u00a0 pg_relation_size(quote_ident(table_name))\nfrom information_schema.tables\nwhere table_schema = 'public'\norder by 3 desc;\n\n-- \u67e5\u770b\u6bcf\u4e2a\u8868\u7684\u884c\u6570\nSELECT \n    schemaname AS schema,\n    relname AS table,\n    n_live_tup AS estimated_row_count\nFROM \n    pg_stat_user_tables\nORDER BY 3 desc;\n\n-- \u67e5\u770b\u67d0\u4e2a\u6570\u636e\u5e93\u78c1\u76d8\u5360\u7528\u60c5\u51b5\nselect pg_size_pretty(pg_database_size('funnydb_web'));\n\n-- \u67e5\u770b\u5168\u90e8\u6570\u636e\u5e93\u78c1\u76d8\u5360\u7528\u60c5\u51b5\nSELECT datname as db_name, pg_size_pretty(pg_database_size(datname)) as db_usage FROM pg_database order by db_usage desc;\n```\n\n---\n\n### \u67e5\u8be2\u5217\u7684\u5b57\u6bb5\u7c7b\u578b\n```sql\nselect pg_typeof('column1'), pg_typeof('column2') from table1;\n```\n\n---\n\n### \u6587\u672c\u7c7b\u578b\u5b57\u6bb5\u7684\u6570\u5b57\u5339\u914d\n```sql\nSELECT value, value::numeric FROM property_values where value ~ '^[-0-9.]+$' limit 1000;\n\nselect min(id) from (select '10005' as id union all select '995' as id);  -- \u9519\u8bef\u5199\u6cd5\n```\n\n---\n\n### \u590d\u5236\u8868\n```sql\ncreate table users_old as (select * from users);\n```\n\u3002", "top": 0, "createdAt": 1735194139, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2024-12-26", "dateLabelColor": "#bc4c00"}, "P26": {"htmlDir": "docs/post/Go -quan-ju-shi-qu-she-zhi.html", "labels": ["\u5f00\u53d1"], "postTitle": "Go \u5168\u5c40\u65f6\u533a\u8bbe\u7f6e", "postUrl": "post/Go%20-quan-ju-shi-qu-she-zhi.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/26", "commentNum": 0, "wordCount": 395, "description": "\u6b63\u5e38\u672c\u5730\u5f00\u53d1\u73af\u5883\u7684\u65f6\u533a\u662f\u4e1c\u516b\u533a\uff0c\u7ebf\u4e0a\u670d\u52a1\u5668\u7684\u65f6\u533a\u662f\u96f6\u65f6\u533a\uff0c  \r\n\u8c03\u8bd5\u4e00\u4e9b\u7ebf\u4e0a\u670d\u52a1\u5668\u7684\u65f6\u533a\u95ee\u9898\u7684\u65f6\u5019\uff0c\u5982\u4f55\u901a\u8fc7\u8bbe\u7f6e\u5168\u5c40\u65f6\u533a\u5728\u672c\u5730\u8fdb\u884c\u8c03\u8bd5\u5462\u3002", "top": 0, "createdAt": 1736129282, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-01-06", "dateLabelColor": "#0969da"}, "P27": {"htmlDir": "docs/post/Clickhouse Golang -cong-huan-cun-zhong-du-qu-shi-jian-lei-xing-zi-duan-diu-shi-shi-qu-de-wen-ti.html", "labels": ["\u5f00\u53d1"], "postTitle": "Clickhouse Golang \u4ece\u7f13\u5b58\u4e2d\u8bfb\u53d6\u65f6\u95f4\u7c7b\u578b\u5b57\u6bb5\u4e22\u5931\u65f6\u533a\u7684\u95ee\u9898", "postUrl": "post/Clickhouse%20Golang%20-cong-huan-cun-zhong-du-qu-shi-jian-lei-xing-zi-duan-diu-shi-shi-qu-de-wen-ti.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/27", "commentNum": 0, "wordCount": 821, "description": "### \u80cc\u666f\r\n\r\n\u4f7f\u7528\u4ee5\u4e0b\u4e24\u4e2a\u5305\u8fdb\u884c clickhouse \u67e5\u8be2\u6570\u636e\u7f13\u5b58\uff0c\u53d1\u73b0\u547d\u4e2d\u7f13\u5b58\u65f6\uff0c\u8fd4\u56de\u7684\u65f6\u95f4\u7c7b\u578b\u5b57\u6bb5\u7684\u503c\u504f\u79fb\u4e86\u516b\u4e2a\u5c0f\u65f6\uff0c\u670d\u52a1\u5668\u65f6\u533a\u662f\u96f6\u65f6\u533a\r\n- https://github.com/ClickHouse/clickhouse-go\r\n- https://github.com/night1008/sqlcache\r\n\r\n### \u95ee\u9898\u539f\u56e0\r\n\u76f4\u63a5\u901a\u8fc7\u6570\u636e\u5e93\u67e5\u8be2\u7684\u65f6\u95f4\u662f\u4e1c\u516b\u533a\uff0c\u6bd4\u5982 `2024-12-05 00:00:05.657 +0800 CST`\uff0c\r\n\u4f46\u662f\u540e\u9762\u547d\u4e2d\u7f13\u5b58\u4ece\u4e2d\u62ff\u5230\u7684\u65f6\u533a\u662f\u96f6\u65f6\u533a(\u670d\u52a1\u5668\u65f6\u533a\u662f\u96f6\u65f6\u533a)\uff0c\u6bd4\u5982 `2024-12-04 16:00:05.657 +0000 UTC`\uff0c\r\n\u8fd9\u6837\u518d\u5bf9\u65f6\u95f4\u5b57\u6bb5\u505a\u683c\u5f0f\u5316\u7684\u65f6\u5019\u5c31\u4f1a\u5dee\u4e86\u516b\u4e2a\u65f6\u533a\uff0c\r\n\u4e0d\u8fc7\u8fd9\u65f6\u5019\u7f13\u5b58\u5df2\u4e22\u5931\u4e86\u6700\u5f00\u59cb\u67e5\u8be2\u6240\u643a\u5e26\u7684\u65f6\u533a\r\n\r\n### \u89e3\u51b3\u65b9\u6cd5\r\n1. \u7f13\u5b58\u67e5\u8be2\u6570\u636e\u7684\u540c\u65f6\uff0c\u7f13\u5b58\u5217\u7684\u4fe1\u606f\uff0c\u6765\u81ea sql.DatabaseTypeName()\uff0c\u6bd4\u5982 DateTime64(3, 'Asia/Shanghai')\r\n2. \u67e5\u8be2\u547d\u4e2d\u7f13\u5b58\u65f6\u901a\u8fc7\u89e3\u6790\u5217\u4fe1\u606f\u5217\u5f97\u5230\u65f6\u533a\r\n3. \u5bf9\u65f6\u95f4\u5b57\u6bb5\u6307\u5b9a\u89e3\u6790\u540e\u7684\u65f6\u533a\u8fdb\u884c\u683c\u5f0f\u5316\r\n\r\n\u4e0d\u8fc7\u672c\u8d28\u539f\u56e0\u662f\u7f13\u5b58\u5305\u4f7f\u7528 `msgpack` \u8fdb\u884c\u5e8f\u5217\u5316\uff0c\u8be5\u65b9\u5f0f\u6ca1\u6709\u4fdd\u5b58\u65f6\u533a\u4fe1\u606f\uff0c  \r\n\u56e0\u6b64\u8fd8\u53ef\u4ee5\u6709\u5176\u4ed6\u7684\u89e3\u51b3\u65b9\u6cd5\uff0c\r\n1. \u5bfb\u627e`msgpack` \u5173\u4e8e\u65f6\u95f4\u7c7b\u578b\u7684\u6269\u5c55\r\n2. \u5b9e\u73b0\u65b0\u7684\u7f13\u5b58\u5305\u7684\u63a5\u53e3\uff0c\u4f7f\u7528\u5176\u4ed6\u5e8f\u5217\u5316\u65b9\u5f0f\uff0c\u6bd4\u5982 `json`\r\n\r\n---\r\n\r\n\u53d1\u73b0\u4e00\u4e2a\u6709\u610f\u601d\u7684\u73b0\u8c61\uff0c\u901a\u8fc7 `union` \u7684\u65b9\u5f0f\u67e5\u8be2\u4e24\u6761\u4e0d\u540c\u65f6\u533a\u7684\u6570\u636e\uff0c\u540e\u7eed\u7684\u6570\u636e\u90fd\u4f1a\u8f6c\u6362\u6210\u7b2c\u4e00\u6761\u6570\u636e\u6240\u62e5\u6709\u7684\u65f6\u533a\u3002", "top": 0, "createdAt": 1736147391, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-01-06", "dateLabelColor": "#0969da"}, "P28": {"htmlDir": "docs/post/fen-bu-fen-xi-zhong-ru-he-hua-fen-qu-jian.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u5206\u5e03\u5206\u6790\u4e2d\u5982\u4f55\u5212\u5206\u533a\u95f4", "postUrl": "post/fen-bu-fen-xi-zhong-ru-he-hua-fen-qu-jian.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/28", "commentNum": 0, "wordCount": 1264, "description": "### \u95ee\u9898\r\n\u5206\u5e03\u5206\u6790\u4e2d\u9700\u8981\u6839\u636e\u67d0\u4e00\u6b65\u957f\u5bf9\u4e00\u7ec4\u503c\u8fdb\u884c\u533a\u95f4\u5212\u5206\uff0c\u4e14\u5176\u5305\u542b\u6b63\u8d1f\u6570\u3002", "top": 0, "createdAt": 1736490643, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-01-10", "dateLabelColor": "#0969da"}, "P29": {"htmlDir": "docs/post/Clickhouse -ye-wu-shi-yong-shou-ce.html", "labels": ["\u5f00\u53d1"], "postTitle": "Clickhouse \u4e1a\u52a1\u4f7f\u7528\u624b\u518c", "postUrl": "post/Clickhouse%20-ye-wu-shi-yong-shou-ce.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/29", "commentNum": 0, "wordCount": 777, "description": "### \u53d8\u66f4\u8bed\u53e5\u662f\u5426\u6267\u884c\u5b8c\n```sql\nselect hostname(),* from clusterAllReplicas('default','system.mutations') where is_done = 0;\n```\n---\n\n### \u6e05\u7406\u6570\u636e\u5e93\u8868\n```sql\ntruncate table demo.events_local;\ntruncate table demo_global.users_local;\ntruncate table demo_global.devices_local;\n```\n---\n\n### \u6839\u636e query \u67e5\u8be2 clickhouse \u65e5\u5fd7\n```sql\nselect * from cluster('all-sharded', 'system', 'query_log') where query_id  = '4efbbb9b-b853-44ca-84b2-95ff066895af';\n```\n---\n\n### \u6570\u636e\u5bfc\u51fa\u6210CSV\n```sql\nSELECT * FROM events\nSETTINGS join_use_nulls=1, allow_experimental_analyzer=0\nINTO OUTFILE '\u65b0\u73a9\u5bb6\u9996\u65e5\u9996\u573a\u6218\u573a\u6570\u636e.csv.gz'\nFORMAT CSVWithNames;\n```\n---\n\n### \u6570\u636e\u53bb\u91cd\u9a8c\u8bc1\n```sql\nselect `_part`, `#dt`, `#event`, `#log_id`, count(1), groupArray(hostname()) from events where `#dt` = '2024-07-28' group by 1, 2, 3, 4 order by 5 desc limit 100;\n```\n\u3002", "top": 0, "createdAt": 1736750626, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-01-13", "dateLabelColor": "#0969da"}, "P30": {"htmlDir": "docs/post/tong-yong-ye-wu-shi-yong-shou-ce.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u901a\u7528\u4e1a\u52a1\u4f7f\u7528\u624b\u518c", "postUrl": "post/tong-yong-ye-wu-shi-yong-shou-ce.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/30", "commentNum": 0, "wordCount": 603, "description": "### \u6570\u636e\u5e93\u8868\u6807\u8bc6\u5b57\u6bb5\u751f\u6210\u89c4\u5219\n\n\u6b63\u5e38\u6570\u636e\u5e93\u8bb0\u5f55\u6709\u81ea\u589e\u7684\u6570\u5b57ID\uff0c\u53e6\u5916\u6709\u4e9b\u8bb0\u5f55\u8fd8\u9700\u8981\u751f\u6210\u82f1\u6587\u6807\u8bc6\u5b57\u6bb5\n\n\u6bd4\u5982\u73b0\u5728`\u5e94\u7528`\u8868\u8981\u589e\u52a0\u4e00\u4e2a`\u6807\u8bc6`\u5b57\u6bb5\uff0c\n\u4e0d\u8981\u4f7f\u7528\u4e2d\u6587\u8f6c\u62fc\u97f3\u7684\u65b9\u5f0f\uff0c\u6bd4\u5982 `\u6570\u636e\u6d4b\u8bd5` => `shu_ju_ce_shi_d4qbfwuf`\n\u53ef\u4ee5\u4f7f\u7528 **\u56fa\u5b9a\u957f\u5ea6\u7684\u552f\u4e00\u5b57\u7b26\u4e32**\uff0c\u6bd4\u5982 `app_t07o2yt58p`\n\n\u4f18\u70b9\uff1a\u540e\u7eed\u6539\u540d\u79f0\u53ef\u4ee5\u4e0d\u7528\u53bb\u7ba1\u6807\u8bc6\u5b57\u6bb5\u5185\u5bb9\n\n---\n\n### \u4e1a\u52a1\u5173\u952e\u6b65\u9aa4\u6253\u5370\u65e5\u5fd7\n\n\u6bd4\u5982\u4ee5\u4efb\u52a1\u6267\u884c\u4e3a\u4f8b\uff0c\u5728\u4efb\u52a1\u5f00\u59cb\uff0c\u4efb\u52a1\u9636\u6bb51\uff0c\u4efb\u52a1\u9636\u6bb52\uff0c... \u4efb\u52a1\u9636\u6bb5N\uff0c\u4efb\u52a1\u7ed3\u675f\u90fd\u53ef\u4ee5\u6253\u5370\u4e00\u4e9b\u5173\u952e\u4fe1\u606f\n\n\u4f18\u70b9\uff1a\u65b9\u4fbf\u67e5\u770b\u6267\u884c\u60c5\u51b5\u548c\u540e\u7eed\u5b9a\u4f4d\u95ee\u9898\n\n---\n\n### \u6570\u636e\u5e93\u5b57\u6bb5\u540d\u79f0\u547d\u540d\u89c4\u5219\n\n1. \u5c0f\u5199\u5b57\u6bcd + \u4e0b\u5212\u7ebf\n> \u5b57\u6bb5\u540d\u79f0\u4e2d\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf _\n> \u6bd4\u5982 user_id, created_at, first_name\n> \u4e0d\u4f7f\u7528\u9a7c\u5cf0\u547d\u540d\u6cd5\uff0c\u56e0\u4e3a\u67d0\u4e9b\u6570\u636e\u5e93\uff08\u5982 PostgreSQL\uff09\u9ed8\u8ba4\u5c06\u5b57\u6bb5\u540d\u79f0\u8f6c\u6362\u4e3a\u5c0f\u5199\uff0c\u53ef\u80fd\u5bfc\u81f4\u95ee\u9898\n\n2. \u4f7f\u7528\u524d\u7f00\u6765\u533a\u5206\u5b57\u6bb5\u7c7b\u578b\u6216\u7528\u9014\n> \u4f7f\u7528 is_ \u6216 has_ \u524d\u7f00\u8868\u793a\u5e03\u5c14\u503c\uff0c\u6bd4\u5982\uff0cis_active\uff1a\u662f\u5426\u6fc0\u6d3b\uff1bhas_permission\uff1a\u662f\u5426\u6709\u6743\u9650\n> \u6bd4\u5982\u4e3a\u4e86\u533a\u5206\u7cfb\u7edf\u9884\u7f6e\u548c\u7528\u6237\u81ea\u5b9a\u4e49\uff0c\u53ef\u4ee5\u5bf9\u9884\u7f6e\u5c5e\u6027\u589e\u52a0 pre_ \u7684\u524d\u7f00\n\n3. \u907f\u514d\u7279\u6b8a\u5b57\u7b26\n> \u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528\u5982 #, $, _ \u7684\u524d\u7f00\uff0c\u4ee5\u514d\u51fa\u73b0\u901a\u8fc7\u5b57\u6bb5\u540d\u79f0\u6784\u5efa\u8def\u5f84\u7684\u95ee\u9898\u3002", "top": 0, "createdAt": 1737012910, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-01-16", "dateLabelColor": "#0969da"}, "P31": {"htmlDir": "docs/post/Visual Studio Code -cha-jian-lie-biao.html", "labels": ["\u5f00\u53d1"], "postTitle": "Visual Studio Code \u63d2\u4ef6\u5217\u8868", "postUrl": "post/Visual%20Studio%20Code%20-cha-jian-lie-biao.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/31", "commentNum": 0, "wordCount": 85, "description": "1. [Git Stash](https://marketplace.visualstudio.com/items?itemName=arturock.gitstash)\u3002", "top": 0, "createdAt": 1737780065, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-01-25", "dateLabelColor": "#0969da"}, "P32": {"htmlDir": "docs/post/shi-yong- PostgreSQL + PostgREST -jia-kuai-hou-duan-kai-fa.html", "labels": ["\u5f00\u53d1"], "postTitle": "\u4f7f\u7528 PostgreSQL + PostgREST \u52a0\u5feb\u540e\u7aef\u5f00\u53d1", "postUrl": "post/shi-yong-%20PostgreSQL%20%2B%20PostgREST%20-jia-kuai-hou-duan-kai-fa.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/32", "commentNum": 0, "wordCount": 1242, "description": "\u4f7f\u7528 PostgreSQL + PostgREST\uff0c\u53ef\u4ee5\u7701\u53bb\u5927\u90e8\u5206\u540e\u7aef\u7f16\u5199\u5de5\u4f5c\u3002", "top": 0, "createdAt": 1740281282, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-02-23", "dateLabelColor": "#0969da"}, "P33": {"htmlDir": "docs/post/Clickhouse arrayJoin -shu-zu-zi-duan-wu-zhi-bei-guo-lv-wen-ti.html", "labels": ["\u5f00\u53d1"], "postTitle": "Clickhouse arrayJoin \u6570\u7ec4\u5b57\u6bb5\u65e0\u503c\u88ab\u8fc7\u6ee4\u95ee\u9898", "postUrl": "post/Clickhouse%20arrayJoin%20-shu-zu-zi-duan-wu-zhi-bei-guo-lv-wen-ti.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/33", "commentNum": 0, "wordCount": 1520, "description": "Clickhouse \u4f7f\u7528 arrayJoin \u5c55\u5f00\u6570\u7ec4\u5b57\u6bb5\u65f6\uff0c\u6709\u4e9b\u6570\u7ec4\u5b57\u6bb5\u53ef\u80fd\u662f\u6ca1\u6709\u503c\u7684\uff0c\u8fd9\u65f6\u5019\u8fd9\u4e9b\u8bb0\u5f55\u4f1a\u88ab\u8fc7\u6ee4\u6389\uff0c\u5982\u4e0b\u6240\u793a\uff0c\n\n```sql\nselect *, arrayJoin(a) as b_item from (\n  select array(1, 2, 3) as a, 1 as b\n  union all\n  select array(1) as a, 2 as b\n  union all\n  select array() as a, 3 as b\n)\n\n   \u250c\u2500a\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item\u2500\u2510\n1. \u2502 [1,2,3] \u2502 1 \u2502      1 \u2502\n2. \u2502 [1,2,3] \u2502 1 \u2502      2 \u2502\n3. \u2502 [1,2,3] \u2502 1 \u2502      3 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u250c\u2500a\u2500\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item\u2500\u2510\n4. \u2502 [1] \u2502 2 \u2502      1 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n---\n\n\u89e3\u51b3\u65b9\u6cd5\u5982\u4e0b\n\n```sql\nselect *, arrayJoin(if(empty(a), [null], a)) as b_item from (\n  select array(1, 2, 3) as a, 1 as b\n  union all\n  select array(1) as a, 2 as b\n  union all\n  select array() as a, 3 as b\n)\n\n   \u250c\u2500a\u2500\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item\u2500\u2510\n1. \u2502 [1] \u2502 2 \u2502      1 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u250c\u2500a\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item\u2500\u2510\n2. \u2502 [1,2,3] \u2502 1 \u2502      1 \u2502\n3. \u2502 [1,2,3] \u2502 1 \u2502      2 \u2502\n4. \u2502 [1,2,3] \u2502 1 \u2502      3 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u250c\u2500a\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item\u2500\u2510\n5. \u2502 [] \u2502 3 \u2502   \u1d3a\u1d41\u1d38\u1d38 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n```sql\nselect *, arrayJoin(range(1, length(if(empty(a), [null], a)) + 1)) AS b_item_index from (\n  select array(1, 2, 3) as a, 1 as b\n  union all\n  select array(1) as a, 2 as b\n  union all\n  select array() as a, 3 as b\n)\n\n   \u250c\u2500a\u2500\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item_index\u2500\u2510\n1. \u2502 [1] \u2502 2 \u2502            1 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u250c\u2500a\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item_index\u2500\u2510\n2. \u2502 [] \u2502 3 \u2502            1 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u250c\u2500a\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500b\u2500\u252c\u2500b_item_index\u2500\u2510\n3. \u2502 [1,2,3] \u2502 1 \u2502            1 \u2502\n4. \u2502 [1,2,3] \u2502 1 \u2502            2 \u2502\n5. \u2502 [1,2,3] \u2502 1 \u2502            3 \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\u3002", "top": 0, "createdAt": 1740628323, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-02-27", "dateLabelColor": "#0969da"}, "P34": {"htmlDir": "docs/post/Clickhouse -ru-he-shi-xian-jian-ge-fen-xi.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "Clickhouse \u5982\u4f55\u5b9e\u73b0\u95f4\u9694\u5206\u6790", "postUrl": "post/Clickhouse%20-ru-he-shi-xian-jian-ge-fen-xi.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/34", "commentNum": 0, "wordCount": 4414, "description": "\u901a\u8fc7\u95f4\u9694\u5206\u6790\u67e5\u770b\u8f6c\u5316\u65f6\u957f\u7684\u5206\u5e03\u60c5\u51b5\u3002", "top": 0, "createdAt": 1740729312, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-02-28", "dateLabelColor": "#0969da"}, "P35": {"htmlDir": "docs/post/bu-tong-guang-gao-qu-dao-bao-biao-lei-xing-ji-bie-de-dui-ying-guan-xi.html", "labels": ["\u5f00\u53d1\u601d\u8def"], "postTitle": "\u4e0d\u540c\u5e7f\u544a\u6e20\u9053\u62a5\u8868\u7c7b\u578b\u7ea7\u522b\u7684\u5bf9\u5e94\u5173\u7cfb", "postUrl": "post/bu-tong-guang-gao-qu-dao-bao-biao-lei-xing-ji-bie-de-dui-ying-guan-xi.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/35", "commentNum": 0, "wordCount": 507, "description": "\u4e0d\u540c\u5e7f\u544a\u6e20\u9053\u62a5\u8868\u7c7b\u578b\u7ea7\u522b\u7684\u5bf9\u5e94\u5173\u7cfb\n\n|    | \u817e\u8baf\u5e7f\u544a | \u5de8\u91cf\u5e7f\u544a |\n| -------- | ------- | ------- |\n| \u5e7f\u544a\u4e3b\u5e10\u53f7  | \u8d26\u53f7ID(account_id)    | \u5e7f\u544a\u4e3bid(advertiser_id)   |\n| \u5e7f\u544a\u8ba1\u5212 | \u5e7f\u544a\u7ec4ID(adgroup_id)   | \u9879\u76eeID(cdp_project_id)   |\n| \u5e7f\u544a\u521b\u610f    | \u52a8\u6001\u521b\u610fid(dynamic_creative_id)   | \u5e7f\u544aID(cdp_promotion_id)    |\n\n\u53c2\u8003\u94fe\u63a5\n- [\u817e\u8baf\u5e7f\u544a - \u83b7\u53d6\u65e5\u62a5\u8868](https://developers.e.qq.com/v3.0/docs/api/daily_reports/get)\n- [\u5de8\u91cf\u5e7f\u544a - \u83b7\u53d6\u81ea\u5b9a\u4e49\u62a5\u8868\u53ef\u7528\u6307\u6807\u548c\u7ef4\u5ea6](https://open.oceanengine.com/labels/7/docs/1755261744248832)\n- [\u5de8\u91cf\u5e7f\u544a - \u81ea\u5b9a\u4e49\u62a5\u8868](https://open.oceanengine.com/labels/7/docs/1741387668314126)\u3002", "top": 0, "createdAt": 1741231086, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-03-06", "dateLabelColor": "#0969da"}, "P36": {"htmlDir": "docs/post/Golang MySQL -tong-guo- interface{} -jie-xi-cha-xun-jie-guo-de-nei-rong-wei- []byte.html", "labels": ["\u5f00\u53d1"], "postTitle": "Golang MySQL \u901a\u8fc7 interface{} \u89e3\u6790\u67e5\u8be2\u7ed3\u679c\u7684\u5185\u5bb9\u4e3a []byte", "postUrl": "post/Golang%20MySQL%20-tong-guo-%20interface%7B%7D%20-jie-xi-cha-xun-jie-guo-de-nei-rong-wei-%20%5B%5Dbyte.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/36", "commentNum": 0, "wordCount": 1257, "description": "\u53d1\u73b0 Golang MySQL \u4e0b\uff0cMySQL \u9a71\u52a8\u9ed8\u8ba4\u628a interface{} \u7c7b\u578b\u89e3\u6790\u4e3a []byte\uff0c\u5bfc\u81f4\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u4ee5 Base64 \u7f16\u7801\u5f62\u5f0f\u8fd4\u56de\u3002", "top": 0, "createdAt": 1741598424, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-03-10", "dateLabelColor": "#0969da"}, "P37": {"htmlDir": "docs/post/Golang json.Marshal escape url & to -u0026.html", "labels": ["\u5f00\u53d1"], "postTitle": "Golang json.Marshal escape url & to \\u0026", "postUrl": "post/Golang%20json.Marshal%20escape%20url%20%26%20to%20-u0026.html", "postSourceUrl": "https://github.com/night1008/night1008.github.io/issues/37", "commentNum": 0, "wordCount": 562, "description": "Golang \u5bf9\u5305\u542b\u94fe\u63a5\u5730\u5740\u7684\u6570\u636e\u8fdb\u884c\u5e8f\u5217\u5316\u540e\u53d1\u73b0\u5730\u5740\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\u4e86\uff0c\u6d4b\u8bd5\u4ee3\u7801\u5982\u4e0b\u3002", "top": 0, "createdAt": 1742459242, "style": "", "script": "", "head": "", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "createdDate": "2025-03-20", "dateLabelColor": "#0969da"}}, "singeListJson": {}, "labelColorDict": {"bug": "#ee0701", "duplicate": "#cccccc", "enhancement": "#84b6eb", "help wanted": "#128A0C", "invalid": "#e6e6e6", "question": "#cc317c", "wontfix": "#ffffff", "\u5f00\u53d1": "#1D76DB", "\u5f00\u53d1\u601d\u8def": "#30FA00", "\u751f\u6d3b": "#C1571D"}, "displayTitle": "Night1008", "faviconUrl": "https://github.githubassets.com/favicons/favicon.svg", "ogImage": "https://github.githubassets.com/favicons/favicon.svg", "primerCSS": "<link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />", "homeUrl": "https://night1008.github.io", "prevUrl": "/page2.html", "nextUrl": "disabled"}